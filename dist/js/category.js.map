{"version":3,"sources":["category.js"],"names":["$","categoryData","init","renderDatas","eventList","on","addClass","siblings","removeClass","index","rightData","sessStr","sessionStorage","getItem","categories","sessObj","JSON","parse","Date","now","time","console","log","data","leftData","get","res","meta","status","sessionObj","setItem","stringify","html","i","length","tmpHtml","cat_name","leftScroll","IScroll","children","template","arr","imgLength","rightScroll"],"mappings":"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","sourcesContent":["$(function () {\r\n  /**\r\n   * 业务: \r\n   *     1.轮播图\r\n   *     2.数据渲染\r\n   *     3,滚动事件\r\n   *     4.点击事件\r\n   *     5.左右结构获取事件\r\n   *     6.缓存数据\r\n   */\r\n  var categoryData;\r\n  init()\r\n\r\n  function init() {\r\n    // 获取分类页数据列表\r\n    renderDatas();\r\n    // 一堆事件\r\n    eventList();\r\n  }\r\n\r\n\r\n\r\n  function eventList() {\r\n    // 左侧菜单的点击事件  委托 委派\r\n    $(\".left_menu\").on(\"click\", \"li\", function () {\r\n      $(this).addClass(\"active\").siblings().removeClass(\"active\");\r\n      // 获取 被点击的li标签的索引 \r\n      var index = $(this).index();\r\n      rightData(index);\r\n\r\n    })\r\n  }\r\n\r\n  // 缓存数据\r\n  function renderDatas() {\r\n    // 先获取会话存储中的数据  null  有数据的时候 字符串类型\r\n    let sessStr = sessionStorage.getItem(\"cates\");\r\n    if (!sessStr) {\r\n      // 没有数据  发送请求来获取新数据\r\n      categories();\r\n    } else {\r\n      // 把缓存数据 重新解析成 对象格式\r\n      let sessObj = JSON.parse(sessStr);\r\n      // console.log(Date.now() - sessObj.time);\r\n      \r\n      if (Date.now() - sessObj.time > 5000) {\r\n        console.log(\"数据过期了 需要重新发送请求获取数据\");\r\n        categories();\r\n      } else {\r\n        console.log(\"数据未过期 可以使用 渲染数据\");\r\n        // 获取旧的要渲染的数据\r\n        categoryData = sessObj.data;\r\n        // 分类页左边数据\r\n        leftData();\r\n        // 分类页右边数据\r\n        rightData(0);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  function categories() {\r\n    // console.log(123);\r\n    $.get(\"http://api.pyg.ak48.xyz/api/public/v1/categories\", (res) => {\r\n      // console.log(res)\r\n      if (res.meta.status) {\r\n        categoryData = res.data;\r\n        // console.log(data);\r\n        // 存入 接口的数据  CateDatas=[]   {data:CateDatas,time:当前的时间} \r\n        //  把对象先转成  json 对象\r\n        let sessionObj = {\r\n          data: categoryData,\r\n          time: Date.now()\r\n        };\r\n        sessionStorage.setItem(\"cates\", JSON.stringify(sessionObj));\r\n        // 分类页左边数据\r\n        leftData();\r\n        // 分类页右边数据\r\n        rightData(0);\r\n      }\r\n    })\r\n  }\r\n\r\n  // 获取分类页左边数据\r\n  function leftData() {\r\n\r\n    let html = ``;\r\n    for (let i = 0; i < categoryData.length; i++) {\r\n      let tmpHtml = `\r\n   <li class=\"${i == 0 ?' active' : ''}\">${categoryData[i].cat_name}</li>\r\n  `;\r\n      html += tmpHtml;\r\n    }\r\n    $(\".left_menu\").html(html);\r\n    var leftScroll = new IScroll('#wrapper');\r\n\r\n  }\r\n\r\n\r\n  // 获取分类页右边数据\r\n  function rightData(index) {\r\n\r\n    var data = categoryData[index].children;\r\n\r\n    let html = template(\"leftdata\", {\r\n      arr: data\r\n    });\r\n    $(\".right\").html(html);\r\n\r\n    // 获取要动态渲染的图片的长度\r\n    let imgLength = $(\".right img\").length;\r\n    $('.right img').on('load', function () {\r\n      imgLength--;\r\n\r\n      var rightScroll = new IScroll('.right');\r\n\r\n    })\r\n\r\n  }\r\n\r\n\r\n})"],"file":"category.js"}