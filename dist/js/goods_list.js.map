{"version":3,"sources":["goods_list.js"],"names":["$","QueryObj","query","cid","getUrl","pagenum","pagesize","TotalPage","init","mui","pullRefresh","container","down","auto","callback","cb","data","html","template","arr","endPulldownToRefresh","refresh","goodsSearch","up","console","log","endPullupToRefresh","append","func","get","result","meta","status","goods","Math","ceil","total","name","reg","RegExp","r","window","location","search","substr","match","decodeURI"],"mappings":"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","sourcesContent":["$(function () {\r\n\r\n\r\n\r\n     // 1 发送请求需要的参数对象 全局变量 方便修改\r\n     let QueryObj = {\r\n          // 查询的关键字 可以为空  根据 小米  华为 。。。。\r\n          query: \"\",\r\n          // 分类页面中的每一个小商品的分类id\r\n          // 获取 url上的参数 cid的值\r\n          cid: getUrl('cid'),\r\n          // 页码\r\n          pagenum: 1,\r\n          // 页容量  一页可以存放几条数据\r\n          pagesize: 10\r\n     }\r\n\r\n     // 2 总页码 是在发送请求成功了 才能 正确的赋值\r\n     let TotalPage = 1;\r\n\r\n     init();\r\n\r\n     function init() {\r\n          mui.init({\r\n               pullRefresh: {\r\n                    container: \".pyg_view\",\r\n                    down: {\r\n                         auto: true,\r\n                         //  触发下拉刷新时自动触发\r\n                         callback: function () {\r\n                              let cb = function (data) {\r\n                                   var html = template(\"mainTpl\", {\r\n                                        arr: data\r\n                                   });\r\n                                   $('.goods_list').html(html);\r\n                                   // 结束下拉刷新\r\n                                   mui('.pyg_view').pullRefresh().endPulldownToRefresh();\r\n                              }\r\n                              // 重置页码,变成第一页\r\n                              QueryObj.pagenum = 1;\r\n                              // 重置 上拉组件\r\n                              mui('.pyg_view').pullRefresh().refresh(true);\r\n                              goodsSearch(cb)\r\n\r\n                         }\r\n                    },\r\n                    up: {\r\n                         //  触发上拉刷新时自动触发\r\n                         callback: function () {\r\n                              if (QueryObj.pagenum >= TotalPage) {\r\n                                   console.log(\"没有数据了\");\r\n                                   mui('.pyg_view').pullRefresh().endPullupToRefresh(true);\r\n                              } else {\r\n                                   console.log(\"还有数据哦\");\r\n                                   QueryObj.pagenum++;\r\n                                   let cb = function (data) {\r\n                                        var html = template(\"mainTpl\", {\r\n                                             arr: data\r\n                                        });\r\n                                        $('.goods_list').append(html);\r\n                                        // 结束上拉刷新\r\n                                        mui('.pyg_view').pullRefresh().endPullupToRefresh(false);\r\n                                   }\r\n\r\n                                   goodsSearch(cb);\r\n                              }\r\n                         }\r\n                    }\r\n               }\r\n          });\r\n\r\n\r\n     }\r\n\r\n     // function eventList() {\r\n     //  $('.list').on(\"tap\", \"a\", function () {\r\n     //   let href = this.href;\r\n     //   location.href = href;\r\n     //  })\r\n     // }\r\n\r\n\r\n     // 获取商品列表页的数据\r\n     function goodsSearch(func) {\r\n          // console.log(123);\r\n          $.get(\"http://api.pyg.ak48.xyz/api/public/v1/goods/search\", QueryObj, function (result) {\r\n               if (result.meta.status == 200) {\r\n                    console.log(result);\r\n\r\n                    var data = result.data.goods\r\n                    // 计算总条数\r\n                    TotalPage = Math.ceil(result.data.total / QueryObj.pagesize)\r\n                    console.log(TotalPage);\r\n\r\n                    func(data)\r\n                    // var html = template(\"mainTpl\", {arr: data});\r\n                    // $('.goods_list').html(html);\r\n                    // // 结束下拉刷新\r\n                    // mui('.pyg_view').pullRefresh().endPulldownToRefresh();\r\n               }\r\n\r\n          })\r\n     }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n     // 获取url上的参数 的值\r\n     function getUrl(name) {\r\n          var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n          var r = window.location.search.substr(1).match(reg);\r\n          if (r != null) return decodeURI(r[2]);\r\n          return null;\r\n     }\r\n})"],"file":"goods_list.js"}